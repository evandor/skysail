@localtests
Feature: [Ref.App SingleEntity] - account specific features - HTML 


#Background: 
#    Given a running AccountApplication

@Creation
Scenario: adding a simple account entity with iban
    When I add an account like this:
      | name | account_<random>       |
      | iban | DE00000000000000000000 |
    And I query all accounts
    Then the accounts list page contains such an account:
       | name | account_<random> |
       | iban | DE00000000000000000000 |
    

@Security
Scenario: if the user sends the "created" property it should be ignored
     When I add an account like this:
       | name      | account_<random>        |
       | iban      | DE00000000000000000000  |
       | created   | 1472280000000           |
     And I open the account page
     Then the page contains:
       | name      | account_<random>        |
       | iban      | DE00000000000000000000  |
       | created   | <!>1472280000000        |

@Retrieval
Scenario: retrieving a created account again
     When I add an account like this:
       | name | a new one |
     And I open the account page
     Then the page contains 'a new one'

@Updating
Scenario: updating an account entity
     When I add an account like this:
       | name | another account |
     And I change its 'name' to 'another account II'
     And I open the account page
     Then the page contains 'another account II'

#https://github.com/orientechnologies/orientdb/issues/6306
@Deletion
Scenario: deleting an account
     When I add an account like this:
       | name | account2beDeleted |
     And I delete it again
     And I query all accounts
     Then the result does not contain an account with name 'account2beDeleted'

#JustMe
@Deletion
@Security
Scenario: deleting someone elses account yields error
     When I log in as 'otheruser'
     When I add an account like this:
       | name | account_<random> |
     And I log in as 'admin'
     And I try to delete it again
     Then I get a 'Forbidden' response